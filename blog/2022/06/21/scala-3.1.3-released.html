<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

    <title>Scala 3.1.3 released! | The Scala Programming Language</title>
    
    <meta property="og:title" content="Scala 3.1.3 released!"/>
    
    
    <meta name="twitter:card" content="summary"/>
    <meta name="twitter:site" content="@scala_lang"/>
    <meta name="twitter:creator" content="@scala_lang"/>
    
    <meta property="og:url" content="http://localhost:4000/blog/2022/06/21/scala-3.1.3-released.html"/>
    
    <meta property="og:image" content="http://localhost:4000/resources/img/scala-spiral-3d-2-toned-down.png"/>

    <meta name="viewport" content="width=device-width, initial-scale=1"/>

    <link rel="icon" type="image/png" href="/resources/favicon.ico">
    <link rel="shortcut icon" type="image/png" href="/resources/favicon.ico">
    <link rel="apple-touch-icon" sizes="180x180" href="/resources/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/resources/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/resources/favicon-16x16.png">
    <link rel="manifest" href="/resources/site.webmanifest">
    <link rel="mask-icon" href="/resources/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#15a9ce">
    <meta name="theme-color" content="#ffffff">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.2/css/all.min.css"
      integrity="sha512-1sCRPdkRXhBV2PBLUdRb4tMg1w2YPf37qatUFeS7zlBy7jJI8Lf4VHwWfZZfpXtYSLy85pkm9GaYVYMfw5BC1A=="
      crossorigin="anonymous" referrerpolicy="no-referrer">

    <!-- Custom stylesheet -->
    <link href="/resources/css/unslider-dots.css" rel="stylesheet" type="text/css">
    <link href="/resources/css/unslider.css" rel="stylesheet" type="text/css">
    
    <link rel="stylesheet" href="/resources/css/highlightjs.css" type="text/css" />
    
    <link rel="stylesheet" href="/resources/css/style.css" type="text/css" />
    <link rel="stylesheet" href="/resources/css/vendor/codemirror.css" type="text/css" />
    <link rel="stylesheet" href="/resources/css/vendor/monokai.css" type="text/css" />
    <link rel="stylesheet" href="/resources/css/monospace.css" type="text/css" />

    <!-- Typekit (should stay at top of page, do not move to footer)-->
    <!--<script type="text/javascript" src="//use.typekit.net/abh3wgk.js"></script>
    <script type="text/javascript">try{Typekit.load();}catch(e){}</script> -->

    <!-- Atom feeds -->
    <link rel="alternate" type="application/atom+xml" title="News Feed" href="/feed/index.xml" />
    <link rel="alternate" type="application/atom+xml" title="Blog Feed" href="/feed/blog.xml" />


  </head>
  <body>

<div class="navigation-fade-screen"></div>

<header id="site-header">
	<div class="wrap">
		<nav class="navigation" role="menu">
			<a href="/" class="navigation-bdand">
				<img src="/resources/img/frontpage/scala-logo-white@2x.png" alt="">
			</a>
			<div class="navigation-panel-button">
				<i class="fa fa-bars"></i>
			</div>
			<ul class="navigation-menu">
				
				    <li class="navigation-menu-item">
                    <a href="https://docs.scala-lang.org" >Learn</a>
				    </li>
				
				    <li class="navigation-menu-item">
                    <a href="/download/" >Install</a>
				    </li>
				
				    <li class="navigation-menu-item">
                    <a href="https://scastie.scala-lang.org" >Playground</a>
				    </li>
				
				    <li class="navigation-menu-item">
                    <a href="https://index.scala-lang.org" >Find a Library</a>
				    </li>
				
				    <li class="navigation-menu-item">
                    <a href="/community/" >Community</a>
				    </li>
				
				    <li class="navigation-menu-item">
                    <a href="/blog/" class="active">Blog</a>
				    </li>
				
			</ul>
		</nav>
	</div>
</header>


<main id="inner-main">

	<!-- Title -->
	<section class="title-page">
		<div class="wrap">
			<h1>Scala 3.1.3 released!</h1>
		</div>
	</section>

	
	<!-- Main content -->
<section class="content">
	<div class="wrap">
		<div class="content-primary">
			<div class="inner-box">
				<div class="blog-detail-head">
					<div>
						<p>Tuesday 21 June 2022</p>
						<p>Pawe≈Ç Marks, VirtusLab</p>
					</div>
					
					<ul class="tag-list">
						
					</ul>
					
					</div>
					<div class="filter-tag"></div>
					<!-- <h2><a href="/blog/2022/06/21/scala-3.1.3-released.html">Scala 3.1.3 released!</a></h2> -->
					<p>We are happy to announce the release of Scala 3.1.3! You can read more about all the improvements and fixes in <a href="https://github.com/lampepfl/dotty/releases/tag/3.1.3">the full changelog</a>. We have also prepared a short list of highlights of the most exciting additions in the new version.</p>

<h2 id="highlights-of-the-release">Highlights of the release</h2>

<h3 id="improved-f-interpolator">Improved f-interpolator</h3>

<p>f-interpolator in Scala 3 has received multiple fixes and improvements recently. Now it has reached feature parity with its Scala 2 counterpart.</p>

<ul>
  <li>
    <p>Cases that were incorrectly failing are now working as intended:</p>

    <div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">f</span><span class="s">"${3.14}%.2f rounds to ${3}%d"</span>           <span class="c1">// "3.14 rounds to 3"</span>
<span class="n">f</span><span class="s">"${java.lang.Boolean.valueOf(false)}%b"</span>  <span class="c1">// "false"</span>
<span class="n">f</span><span class="s">"${BigInt(120)}%d"</span>                       <span class="c1">// "120"</span>
<span class="n">f</span><span class="s">"${3L}%e"</span>                                <span class="c1">// "3.000000e+00"</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p>Backslash escapes are now handled properly and consistently:</p>

    <div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">f</span><span class="s">"yes\\\no"</span>   <span class="c1">// "yes\</span>
              <span class="c1">//  o"</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p>Many cases that were throwing runtime exceptions are now causing compilation errors instead:</p>

    <div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">f</span><span class="s">"{1} % y"</span>  <span class="c1">// Error: illegal conversion character 'y'</span>
</code></pre></div>    </div>
  </li>
</ul>

<h3 id="better-error-reporting-in-inlined-code">Better error reporting in inlined code</h3>

<p>When the compiler reports an error that occurred in inlined code, it now displays the source from where the inlined function was invoked. That gives more context to the users on what happened and where the error came from.</p>

<p>For example, the snippet:</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">trait</span> <span class="nc">Foo</span><span class="o">[</span><span class="kt">X</span><span class="o">]</span><span class="nc">:</span>
  <span class="k">def</span> <span class="nf">foo</span><span class="k">:</span> <span class="kt">Int</span>

<span class="k">def</span> <span class="nf">foo</span> <span class="k">=</span>
  <span class="n">first</span><span class="o">[</span><span class="kt">String</span><span class="o">]</span>

<span class="n">inline</span> <span class="k">def</span> <span class="nf">second</span><span class="o">[</span><span class="kt">A</span><span class="o">]</span><span class="k">:</span> <span class="kt">Int</span> <span class="o">=</span>
  <span class="nv">compiletime</span><span class="o">.</span><span class="py">summonInline</span><span class="o">[</span><span class="kt">Foo</span><span class="o">[</span><span class="kt">A</span><span class="o">]].</span><span class="py">foo</span>

<span class="n">inline</span> <span class="k">def</span> <span class="nf">first</span><span class="o">[</span><span class="kt">A</span><span class="o">]</span><span class="k">:</span> <span class="kt">Int</span> <span class="o">=</span>
  <span class="n">second</span><span class="o">[</span><span class="kt">A</span><span class="o">]</span> <span class="o">+</span> <span class="mi">42</span>
</code></pre></div></div>

<p>will now report a compilation error looking like this</p>

<p><img src="/resources/img/inline-error-after.png" alt="the new error" /></p>

<p>instead of previously</p>

<p><img src="/resources/img/inline-error-before.png" alt="the old error" /></p>

<h3 id="possibility-to-generate-arbitrary-class-implementations-in-macros">Possibility to generate arbitrary class implementations in macros</h3>

<p>For a long time, generating arbitrary classes was not possible using the quotes api. With 3.1.3, the situation has changed. We added two missing blocks: experimental methods <code class="language-plaintext highlighter-rouge">ClassDef.apply</code> and <code class="language-plaintext highlighter-rouge">Symbol.newClass</code>. Now using them, you can write a snippet similar to the following:</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="nn">scala.quoted.</span><span class="o">*</span>

<span class="k">class</span> <span class="nc">Base</span>

<span class="n">transparent</span> <span class="n">inline</span> <span class="k">def</span> <span class="nf">classNamed</span><span class="o">(</span><span class="n">inline</span> <span class="n">name</span><span class="k">:</span> <span class="kt">String</span><span class="o">)</span> <span class="k">=</span> <span class="n">$</span><span class="o">{</span> <span class="nf">classNamedExpr</span><span class="o">(</span><span class="ss">'name</span><span class="o">)</span> <span class="o">}</span>
<span class="k">def</span> <span class="nf">classNamedExpr</span><span class="o">(</span><span class="n">nameExpr</span><span class="k">:</span> <span class="kt">Expr</span><span class="o">[</span><span class="kt">String</span><span class="o">])(</span><span class="n">using</span> <span class="nc">Quotes</span><span class="o">)</span><span class="k">:</span> <span class="kt">Expr</span><span class="o">[</span><span class="kt">Any</span><span class="o">]</span> <span class="k">=</span>
  <span class="k">import</span> <span class="nn">quotes.reflect.</span><span class="o">*</span>

  <span class="k">val</span> <span class="nv">name</span> <span class="k">=</span> <span class="nv">nameExpr</span><span class="o">.</span><span class="py">valueOrAbort</span>
  <span class="k">val</span> <span class="nv">parents</span> <span class="k">=</span> <span class="nc">List</span><span class="o">(</span><span class="nv">TypeTree</span><span class="o">.</span><span class="py">of</span><span class="o">[</span><span class="kt">Base</span><span class="o">])</span>
  <span class="k">def</span> <span class="nf">decls</span><span class="o">(</span><span class="n">cls</span><span class="k">:</span> <span class="kt">Symbol</span><span class="o">)</span> <span class="k">=</span> <span class="nv">List</span><span class="o">.</span><span class="py">empty</span>  <span class="c1">// put something interesting here</span>
  <span class="k">val</span> <span class="nv">body</span> <span class="k">=</span> <span class="nv">List</span><span class="o">.</span><span class="py">empty</span>                <span class="c1">// ...and here</span>

  <span class="k">val</span> <span class="nv">symbol</span> <span class="k">=</span> <span class="nv">Symbol</span><span class="o">.</span><span class="py">newClass</span><span class="o">(</span><span class="nv">Symbol</span><span class="o">.</span><span class="py">spliceOwner</span><span class="o">,</span> <span class="n">name</span><span class="o">,</span> <span class="nv">parents</span><span class="o">.</span><span class="py">map</span><span class="o">(</span><span class="nv">_</span><span class="o">.</span><span class="py">tpe</span><span class="o">),</span> <span class="n">decls</span><span class="o">,</span> <span class="n">selfType</span> <span class="k">=</span> <span class="nc">None</span><span class="o">)</span>
  <span class="k">val</span> <span class="nv">classDef</span> <span class="k">=</span> <span class="nc">ClassDef</span><span class="o">(</span><span class="n">symbol</span><span class="o">,</span> <span class="n">parents</span><span class="o">,</span> <span class="n">body</span><span class="o">)</span>
  <span class="k">val</span> <span class="nv">ctor</span> <span class="k">=</span> <span class="nc">Select</span><span class="o">(</span><span class="nc">New</span><span class="o">(</span><span class="nc">TypeIdent</span><span class="o">(</span><span class="n">symbol</span><span class="o">)),</span> <span class="nv">symbol</span><span class="o">.</span><span class="py">primaryConstructor</span><span class="o">)</span>
  <span class="k">val</span> <span class="nv">newClass</span> <span class="k">=</span> <span class="nc">Typed</span><span class="o">(</span><span class="nc">Apply</span><span class="o">(</span><span class="n">ctor</span><span class="o">,</span> <span class="nc">Nil</span><span class="o">),</span> <span class="nv">TypeTree</span><span class="o">.</span><span class="py">of</span><span class="o">[</span><span class="kt">Base</span><span class="o">])</span>

  <span class="nc">Block</span><span class="o">(</span><span class="nc">List</span><span class="o">(</span><span class="n">classDef</span><span class="o">),</span> <span class="n">newClass</span><span class="o">).</span><span class="py">asExprOf</span><span class="o">[</span><span class="kt">Base</span><span class="o">]</span>
</code></pre></div></div>

<p>Then you can invoke the macro with</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">val</span> <span class="nv">impl</span><span class="k">:</span> <span class="kt">Base</span> <span class="o">=</span> <span class="nf">classNamed</span><span class="o">(</span><span class="s">"Foo"</span><span class="o">)</span>
</code></pre></div></div>

<p>creating the new instance of your custom subclass of <code class="language-plaintext highlighter-rouge">Base</code>. That can be useful for the compile-time generation of proxies for remote procedure call systems and many other advanced use-cases.</p>

<h2 id="contributors">Contributors</h2>

<p>Thank you to all the contributors who made this release possible.</p>

<p>According to <code class="language-plaintext highlighter-rouge">git shortlog -sn --no-merges 3.1.2..3.1.3</code> these are:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    66  odersky
    48  Nicolas Stucki
    38  Filip Zyba≈Ça
    36  Martin Odersky
    29  noti0na1
    27  Som Snytt
    24  Dale Wijnand
    19  Anatolii Kmetiuk
    19  Chris Kipp
    18  Pawe≈Ç Marks
    17  Rikito Taniguchi
    13  Xavientois
    13  Tom Grigg
    12  Jan Chyb
    11  Guillaume Martres
     8  Jamie Thompson
     8  Matt Bovel
     6  Tomasz Godzik
     5  Michael Pilquist
     5  rochala
     4  adampauls
     4  Kacper Korban
     3  S√©bastien Doeraene
     3  Andrzej Ressel
     3  Olivier Blanvillain
     3  Phil
     3  Seth Tisue
     2  St√©phane Micheloud
     2  Yichen Xu
     2  Arman Bilge
     2  Julien Richard-Foy
     2  Adrien Piquerez
     1  ireina7
     1  Alexander Ioffe
     1  Jentsch
     1  Jƒôdrzej Rochala
     1  Micha≈Ç Pa≈Çka
     1  Ondrej Lhotak
     1  Pascal Weisenburger
     1  Quentin Bernet
     1  Ruslan Shevchenko
     1  SrTobi
     1  Stephane MICHELOUD
     1  Vadim Chelyshov
     1  Vasil Vasilev
     1  bjornregnell
     1  ghostbuster91
     1  som-snytt
     1  ≈Åukasz Wro≈Ñski
</code></pre></div></div>

				</div>
			</div>
			<!-- TOC -->
			
<div class="content-nav">
	<div class="inner-box sidebar-toc-wrapper" style="">
		<h5>Contents</h5>
		<div class="inner-toc" id="sidebar-toc">

		</div>
		<hr>
		<div class="help-us"><a href="https://github.com/scala/scala-lang/blob/master/blog/_posts/2022-06-21-scala-3.1.3-released.md" data-proofer-ignore><i class="fa fa-pencil" aria-hidden="true"></i> Problem with this page?<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Please help us fix it!</a></div>
	</div>
</div>


		</div>
	</div>
</section>


</main>

<footer id="site-footer">
    <div class="wrap">
      <div class="site-footer-top">
        
          <ul class="documentation">
            <li><h3>Documentation</h3></li>
            
              
                <li><a href="https://docs.scala-lang.org/getting-started.html">Getting Started</a></li>
              
            
              
                <li><a href="https://www.scala-lang.org/api/current/index.html">API</a></li>
              
            
              
                <li><a href="https://docs.scala-lang.org/overviews">Overviews/Guides</a></li>
              
            
              
                <li><a href="https://scala-lang.org/files/archive/spec/2.13/">Language Specification</a></li>
              
            
          </ul>
        
          <ul class="download">
            <li><h3>Download</h3></li>
            
              
                <li><a href="/download/">Current Version</a></li>
              
            
              
                <li><a href="/download/all.html">All versions</a></li>
              
            
          </ul>
        
          <ul class="community">
            <li><h3>Community</h3></li>
            
              
                <li><a href="/community/">Community</a></li>
              
            
              
                <li><a href="/community/index.html#forums">Forums</a></li>
              
            
              
                <li><a href="/community/index.html#chat-rooms">Chat</a></li>
              
            
              
                <li><a href="/community/index.html#community-libraries-and-tools">Libraries and Tools</a></li>
              
            
              
                <li><a href="https://scala.epfl.ch/">The Scala Center</a></li>
              
            
          </ul>
        
          <ul class="contribute">
            <li><h3>Contribute</h3></li>
            
              
                <li><a href="/contribute/">How to help</a></li>
              
            
              
                <li><a href="/contribute/bug-reporting-guide.html">Report an Issue</a></li>
              
            
          </ul>
        
          <ul class="scala">
            <li><h3>Scala</h3></li>
            
              
                <li><a href="/blog/">Blog</a></li>
              
            
              
                <li><a href="/conduct.html">Code of Conduct</a></li>
              
            
              
                <li><a href="/license/">License</a></li>
              
            
          </ul>
        
          <ul class="social">
            <li><h3>Social</h3></li>
            
              
                <li><a href="https://github.com/scala">GitHub</a></li>
              
            
              
                 <!-- special case Manstodon to validate with rel="me" -->
                <li><a rel="me" href="https://fosstodon.org/@scala_lang">Mastodon</a></li>
              
            
              
                <li><a href="https://twitter.com/scala_lang">Twitter</a></li>
              
            
              
                <li><a href="https://discord.com/invite/scala">Discord</a></li>
              
            
              
                <li><a href="https://www.linkedin.com/company/scala-center/">LinkedIn</a></li>
              
            
          </ul>
        
      </div>
      <div class="site-footer-bottom">
        <p>Copyright ¬© 2002-2023 √âcole Polytechnique F√©d√©rale <br>Lausanne (EPFL) Lausanne, Switzerland</p>
        <img src="/resources/img/frontpage/scala-logo-white.png" alt="">
      </div>
    </div>
  </footer>

    <!-- jquery -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
    <script src="/resources/js/vendor/jquery.autocomplete.js" type="text/javascript" ></script>

    <!-- tweet feed -->
    <script src="/resources/js/tweetMachine-update.js" type="text/javascript" ></script>

    <!-- prettify js -->
    <script src="/resources/js/vendor/prettify/prettify.js" type="text/javascript" ></script>
    <script src="/resources/js/vendor/prettify/lang-scala.js" type="text/javascript" ></script>

    <!-- unslider js -->
    <script src="/resources/js/vendor/unslider.js" type="text/javascript" ></script>

    <!-- Highlight -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.5.1/highlight.min.js" type="text/javascript"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.5.1/languages/scala.min.js" type="text/javascript"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.5.1/languages/java.min.js" type="text/javascript"></script>

    <!-- Custom Syntax Highlight -->
    <script src="/resources/js/hljs-scala3.js" type="text/javascript"></script>

    <!-- CodeMirror -->
    <script src="/resources/js/vendor/codemirror/codemirror.js" type="text/javascript"></script>
    <script src="/resources/js/vendor/codemirror/clike.js" type="text/javascript"></script>

    <!-- TOC -->
    
      <script src="/resources/js/vendor/jquery.sticky.js" type="text/javascript" ></script>
      <script src="/resources/js/vendor/toc.js" type="text/javascript" ></script>
    

    <!-- Blog search -->
    <script src="/resources/js/vendor/jekyll.search.min.js" type="text/javascript"></script>

    <!-- Custom javascript -->
    <script src="/resources/js/functions.js" type="text/javascript"></script>
    <script defer data-domain="scala-lang.org" src="https://plausible.scala-lang.org/js/script.js"></script>
  </body>
</html>
